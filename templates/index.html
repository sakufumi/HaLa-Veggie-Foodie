<!DOCTYPE html>
<html>

<head>
  <title>HaLa Veggie Foodie - Iwate Restaurant Search</title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
</head>

<body>
  <header style="text-align: center; margin-bottom: 20px;">
    <img src="{{ url_for('static', filename='img/logo.png') }}" alt="HaLa Veggie Foodie Logo" style="height: auto; margin-bottom: 10px;">
    <h1 style="color: #88b04b; font-family: 'Quicksand', sans-serif;">HaLa Veggie Foodie</h1>
    <p style="color: #555; font-size: 30px;">Iwate Restaurant Search</p>
  </header>

  <div class="container">
    <div class="search-panel">
      <form method="get" action="/">
        <label for="genre">🍃 Genre:</label>
        <input type="text" name="genre" id="genre">

        <label for="type">🥗 Type:</label>
        <input type="text" name="type" id="type">

        <label for="area">📍 Area:</label>
        <input type="text" name="area" id="area">

        <button type="submit">Search</button>
      </form>

      <hr>

      {% for restaurant in restaurants %}
      <div class="restaurant">
        <h2>{{ restaurant.name }}</h2>
        <p><strong>☕ Category:</strong> {{ restaurant.category }}</p>
        <p><strong>🍃 Genre:</strong> {{ restaurant.genre }}</p>
        <p><strong>🥗 Type:</strong> {{ restaurant.halal_or_veg }}</p>
        <p><strong>📍 Area:</strong> {{ restaurant.area }}</p>
      </div>
      {% endfor %}
    </div>

    <div class="map-panel">
      <div id="map"></div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([39.7036, 141.1527], 10);

    // 英語表記の地図タイル（CartoDB Positron）
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://carto.com/">CARTO</a> & contributors'
    }).addTo(map);

    // エリアマーカー＋英語ラベル
    const areas = [
      { name: "Looney", coords: [39.658366813317066, 141.15665587062819] },
      { name: "Karakoma", coords: [39.705052, 141.158594] },
      { name: "Chef", coords: [39.69818385635047, 141.02387523448388] },
      { name: "Usagi Botanica", coords: [39.701275155519355, 141.02387523448388] }
    ];

    areas.forEach(area => {
      L.marker(area.coords).addTo(map)
        .bindTooltip(area.name, { permanent: true, direction: 'right' })
        .bindPopup(`
          <b>${area.name}</b><br>
          ${area.description}<br>
          <a href="/?area=${area.name}">Explore restaurants in ${area.name}</a>
        `);
    });
  </script>
</body>

</html>
